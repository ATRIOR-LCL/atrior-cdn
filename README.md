# è…¾è®¯äº‘ COS æ–‡ä»¶ä¸Šä¼ æœåŠ¡

ä¸€ä¸ªåŸºäº Node.js çš„è…¾è®¯äº‘ COS æ–‡ä»¶ä¸Šä¼ æœåŠ¡ï¼Œæ”¯æŒè‡ªåŠ¨æ–‡ä»¶åˆ†ç±»å’Œå¯é…ç½®çš„æ ¹ç›®å½•ã€‚

## âœ¨ ç‰¹æ€§

- ğŸš€ **è‡ªåŠ¨æ–‡ä»¶åˆ†ç±»** - æ ¹æ®æ–‡ä»¶æ‰©å±•åè‡ªåŠ¨åˆ†ç±»åˆ°å¯¹åº”ç›®å½•
- ğŸ“ **å¯é…ç½®æ ¹ç›®å½•** - é€šè¿‡ç¯å¢ƒå˜é‡è‡ªå®šä¹‰æ–‡ä»¶å­˜å‚¨çš„æ ¹ç›®å½•
- ğŸ”’ **å®‰å…¨çš„ä¸´æ—¶å¯†é’¥** - ä½¿ç”¨è…¾è®¯äº‘ STS ä¸´æ—¶å¯†é’¥ï¼Œå®‰å…¨å¯é 
- âš¡ **æ—¶é—´æˆ³å‘½å** - æ–‡ä»¶ååŒ…å«æ—¶é—´æˆ³ï¼Œé¿å…é‡åå†²çª
- ğŸ¯ **çµæ´»è·¯å¾„** - æ”¯æŒè‡ªå®šä¹‰å­ç›®å½•ï¼Œä¹Ÿå¯è‡ªåŠ¨åˆ†ç±»

## ğŸ“‚ æ–‡ä»¶è‡ªåŠ¨åˆ†ç±»

| æ–‡ä»¶ç±»å‹ | ç›®å½• | æ”¯æŒæ ¼å¼ |
|---------|------|----------|
| å›¾ç‰‡ | `/images/` | jpg, png, gif, svg, webp, ico ç­‰ |
| è§†é¢‘ | `/video/` | mp4, avi, mov, mkv, webm ç­‰ |
| éŸ³é¢‘ | `/audio/` | mp3, wav, flac, aac, ogg ç­‰ |
| æ–‡æ¡£ | `/docs/` | pdf, doc, txt, md, xlsx ç­‰ |
| æ ·å¼ | `/css/` | css, scss, sass, less |
| å…¶ä»– | `/other/` | å…¶ä»–æ‰€æœ‰æ ¼å¼ |

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–
```bash
# pnpm
pnpm install

# npm
npm install
```

### 2. é…ç½®ç¯å¢ƒå˜é‡
åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹åˆ›å»º `.env` å¹¶å¤åˆ¶ä¸‹æ–¹æ–‡æœ¬åˆ° `.env` æ–‡ä»¶ä¸­ï¼Œè°ƒæ•´ä½ è‡ªå·±çš„å‚æ•°é…ç½®ï¼š
```env
# è…¾è®¯äº‘å¯†é’¥ï¼ˆå¿…å¡«ï¼‰
SecretId=ä½ çš„SecretId
SecretKey=ä½ çš„SecretKey

# COS é…ç½®ï¼ˆå¿…å¡«ï¼‰
Bucket=ä½ çš„å­˜å‚¨æ¡¶åç§°
Region=å­˜å‚¨æ¡¶åœ°åŸŸ

# ä¸“å±ç›®å½•é…ç½®ï¼ˆå¯é€‰ï¼Œé»˜è®¤: atriorï¼‰
RootPath=atrior

# CDN è®¿é—®åŸŸåé…ç½®ï¼ˆå¯é€‰ï¼‰
CdnDomain=https://cdn.shaly.sdutacm.cn
```

### 3. å¯åŠ¨æœåŠ¡
```bash
node index.js
```

æœåŠ¡å°†åœ¨ `http://127.0.0.1:3000` å¯åŠ¨

## ğŸ“‹ ä½¿ç”¨æ–¹æ³•

### å‘½ä»¤è¡Œä¸Šä¼ ï¼ˆæ¨èï¼‰
```bash
# è‡ªåŠ¨åˆ†ç±»ä¸Šä¼ 
node upload-client.js photo.jpg
# ç»“æœ: atrior/images/æ—¶é—´æˆ³_photo.jpg

# æŒ‡å®šå­ç›®å½•ä¸Šä¼ 
node upload-client.js photo.jpg gallery/2024
# ç»“æœ: atrior/gallery/2024/æ—¶é—´æˆ³_photo.jpg
```

### API è°ƒç”¨
```bash
# è·å–ä¸Šä¼ å‡­è¯
curl "http://127.0.0.1:3000/getKeyAndCredentials?filename=photo.jpg"

# æŒ‡å®šå­ç›®å½•
curl "http://127.0.0.1:3000/getKeyAndCredentials?filename=photo.jpg&path=custom"
```

### æ¼”ç¤ºè„šæœ¬
```bash
./demo.sh
```

## ğŸ”§ æ ¹ç›®å½•é…ç½®

### ä¿®æ”¹æ ¹ç›®å½•
åœ¨ `.env` æ–‡ä»¶ä¸­ä¿®æ”¹ `RootPath` å‚æ•°ï¼š

```env
RootPath=atrior
```

### é…ç½®ç¤ºä¾‹
| RootPath | å›¾ç‰‡è·¯å¾„ | æ–‡æ¡£è·¯å¾„ |
|----------|----------|----------|
| `atrior` | `atrior/images/` | `atrior/docs/` |
| `beacon` | `beacon/images/` | `beacon/docs/` |
| `coolarec` | `coolarec/images/` | `coolarec/docs/` |

## ğŸ“ é¡¹ç›®ç»“æ„

```
atrior-cdn/
â”œâ”€â”€ index.js           # ä¸»æœåŠ¡æ–‡ä»¶
â”œâ”€â”€ upload-client.js   # ä¸Šä¼ å®¢æˆ·ç«¯
â”œâ”€â”€ demo.sh           # æ¼”ç¤ºè„šæœ¬
â”œâ”€â”€ CONFIG.md         # è¯¦ç»†é…ç½®è¯´æ˜
â”œâ”€â”€ README.md         # é¡¹ç›®è¯´æ˜
â”œâ”€â”€ .env              # ç¯å¢ƒé…ç½®
â”œâ”€â”€ package.json      # ä¾èµ–é…ç½®
```

## ğŸ” å®‰å…¨æ³¨æ„äº‹é¡¹

1. **ç¯å¢ƒå˜é‡ä¿æŠ¤** - ä¸è¦å°† `.env` æ–‡ä»¶æäº¤åˆ°ç‰ˆæœ¬æ§åˆ¶
2. **å¯†é’¥æƒé™** - å»ºè®®ä¸ºæœåŠ¡åˆ›å»ºä¸“é—¨çš„å­è´¦å·ï¼Œåªæˆäºˆå¿…è¦æƒé™
3. **ç½‘ç»œå®‰å…¨** - ç”Ÿäº§ç¯å¢ƒå»ºè®®é…ç½® HTTPS å’Œè®¿é—®é™åˆ¶
4. **ä¸´æ—¶å¯†é’¥** - ç³»ç»Ÿä½¿ç”¨ä¸´æ—¶å¯†é’¥ï¼Œé»˜è®¤30åˆ†é’Ÿè¿‡æœŸ

## ğŸ“š è¯¦ç»†æ–‡æ¡£

- [CONFIG.md](CONFIG.md) - è¯¦ç»†é…ç½®è¯´æ˜
- [è…¾è®¯äº‘ COS æ–‡æ¡£](https://cloud.tencent.com/document/product/436)

## ğŸ› ï¸ å¼€å‘

### ç¯å¢ƒè¦æ±‚
- Node.js >= 14
- pnpm (æ¨è) æˆ– npm

### æœ¬åœ°å¼€å‘
```bash
# å®‰è£…ä¾èµ–
pnpm install

# å¯åŠ¨å¼€å‘æœåŠ¡
node index.js

# æµ‹è¯•ä¸Šä¼ 
node upload-client.js <your-file-path>
# demo: node upload-client.js demo.png
```

## ğŸ“„ è®¸å¯è¯

MIT License
